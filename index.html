<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catalyst AI Registry</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
<script src="https://d3js.org/d3.v7.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
:root{--bg:#09090b;--fg:#e2e8f0;--fg-muted:#94a3b8;--fg-subtle:#64748b;--border:rgba(255,255,255,.1);--border-s:rgba(255,255,255,.05);--card:rgba(24,24,27,.5);--card-h:rgba(24,24,27,.7)}
*{margin:0;padding:0;box-sizing:border-box}

@keyframes aurora{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes shine{0%{transform:translateX(-100%) skewX(-20deg)}100%{transform:translateX(200%) skewX(-20deg)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}

html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--fg);min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background-image:radial-gradient(circle at 20% 20%,rgba(56,189,248,.08),transparent 30%),radial-gradient(circle at 80% 70%,rgba(167,139,250,.08),transparent 30%),radial-gradient(rgba(255,255,255,.02) 1px,transparent 1px);background-size:200% 200%,200% 200%,24px 24px;animation:aurora 20s ease infinite;pointer-events:none;z-index:0}

.wrap{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:40px 24px}
@media(max-width:640px){.wrap{padding:24px 16px}}

/* Fade-in on scroll */
.reveal{opacity:0;transform:translateY(16px);transition:opacity .6s cubic-bezier(.4,0,.2,1),transform .6s cubic-bezier(.4,0,.2,1)}
.reveal.visible{opacity:1;transform:translateY(0)}

/* Header */
.hdr{display:flex;align-items:center;gap:18px;margin-bottom:12px;animation:fadeUp .8s ease}
.hdr-icon{width:52px;height:52px;background:linear-gradient(135deg,#38bdf8,#818cf8);border-radius:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 0 24px rgba(56,189,248,.2)}
.hdr-icon svg{width:24px;height:24px;fill:none;stroke:#fff;stroke-width:2}
.hdr h1{font-size:30px;font-weight:900;color:#f4f4f5;letter-spacing:-.5px}
.hdr .sub{font-size:14px;color:var(--fg-subtle);margin-top:3px;display:flex;align-items:center;gap:8px}
.hdr .live{width:6px;height:6px;background:#4ade80;border-radius:50%;animation:pulse 2s ease infinite}
@media(max-width:640px){.hdr h1{font-size:24px}.hdr .sub{font-size:12px}}

/* Section dividers */
.divider{display:flex;align-items:center;gap:12px;margin:40px 0 20px}
.divider-line{height:1px;background:var(--border-s);flex-grow:1}
.divider-label{font-size:11px;font-weight:700;color:var(--fg-subtle);text-transform:uppercase;letter-spacing:1px;white-space:nowrap}

/* Stats */
.stats{display:grid;grid-template-columns:repeat(6,1fr);gap:14px}
@media(max-width:900px){.stats{grid-template-columns:repeat(3,1fr)}}
@media(max-width:640px){.stats{grid-template-columns:repeat(2,1fr)}}
.sc{background:var(--card);border:1px solid var(--border-s);border-radius:12px;padding:18px;backdrop-filter:blur(16px);position:relative;overflow:hidden;transition:all .3s}
.sc::before{content:'';position:absolute;inset:0;background:radial-gradient(300px circle at var(--x,50%) var(--y,50%),rgba(129,140,248,.12),transparent 40%);opacity:0;transition:opacity .3s;pointer-events:none}
.sc:hover{border-color:var(--border);transform:translateY(-2px)}
.sc:hover::before{opacity:1}
.sc .v{font-size:30px;font-weight:900;color:#f4f4f5;letter-spacing:-.5px}
.sc .l{font-size:11px;color:var(--fg-subtle);text-transform:uppercase;letter-spacing:.5px;margin-top:4px}

/* Cards */
.grid2{display:grid;grid-template-columns:3fr 2fr;gap:20px;margin-bottom:0}
.grid2e{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:0}
@media(max-width:800px){.grid2,.grid2e{grid-template-columns:1fr}}
.card{background:var(--card);border:1px solid var(--border-s);border-radius:16px;overflow:hidden;backdrop-filter:blur(16px);transition:all .3s;position:relative}
.card:hover{background:var(--card-h);border-color:var(--border);transform:translateY(-1px);box-shadow:0 8px 32px rgba(0,0,0,.3)}
.card-h{padding:16px 20px;border-bottom:1px solid var(--border-s);display:flex;align-items:center;gap:10px}
.card-h .dot{width:8px;height:8px;border-radius:50%}
.card-h h2{font-size:13px;font-weight:700;color:var(--fg-muted);letter-spacing:.3px}
.card-b{padding:20px}
.full{margin-bottom:0}

/* Bars */
.bar{display:flex;align-items:center;margin-bottom:5px}
.bar-n{width:100px;font-size:11px;color:var(--fg-muted);text-align:right;padding-right:10px;flex-shrink:0}
.bar-t{flex:1;height:26px;background:rgba(255,255,255,.03);border-radius:6px;overflow:hidden}
.bar-f{height:100%;border-radius:6px;display:flex;align-items:center;padding-left:8px;font-size:10px;font-weight:700;color:#fff;transition:width 1.2s cubic-bezier(.4,0,.2,1)}

/* Link table */
.lt{width:100%;border-collapse:collapse;font-size:11px}
.lt th{text-align:left;color:var(--fg-subtle);font-size:9px;text-transform:uppercase;letter-spacing:.5px;padding:6px;border-bottom:1px solid var(--border-s)}
.lt td{padding:6px;border-bottom:1px solid rgba(255,255,255,.02)}
.lt tr:hover{background:rgba(255,255,255,.02)}
.badge{display:inline-block;padding:2px 7px;border-radius:4px;font-size:9px;font-weight:700}

/* D3 */
#network{width:100%;height:500px;position:relative}
#network svg{width:100%;height:100%}
.node-label{font-size:10px;fill:#e2e8f0;font-weight:600;pointer-events:none;text-anchor:middle}
.tooltip{position:absolute;background:rgba(24,24,27,.95);border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:10px 14px;font-size:11px;pointer-events:none;opacity:0;transition:opacity .15s;z-index:10;backdrop-filter:blur(8px)}

/* Tag grid */
.tg{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
@media(max-width:640px){.tg{grid-template-columns:repeat(2,1fr)}}
.tc{padding:10px;border-radius:8px;text-align:center;transition:all .2s}
.tc:hover{transform:scale(1.05);box-shadow:0 4px 16px rgba(0,0,0,.3)}
.tc .tn{font-size:11px;font-weight:700;color:#e2e8f0}
.tc .tv{font-size:10px;color:var(--fg-muted);margin-top:2px}

/* Donut */
.art-row{display:flex;align-items:center;gap:24px}
@media(max-width:640px){.art-row{flex-direction:column}}
.donut-w{position:relative;width:130px;height:130px;flex-shrink:0}
.donut-c{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.donut-c .p{font-size:24px;font-weight:900;color:#f4f4f5}
.donut-c .pl{font-size:9px;color:var(--fg-subtle)}
.art-l{display:grid;grid-template-columns:1fr 1fr;gap:4px 16px;font-size:11px}
.art-l .ai{display:flex;align-items:center;gap:6px}
.art-l .ad{width:6px;height:6px;border-radius:50%;flex-shrink:0}

/* Charts */
.chart-wrap{height:220px;position:relative}

/* Arch */
.arch{display:flex;flex-direction:column;gap:12px}
.arch-r{display:flex;gap:12px}
@media(max-width:600px){.arch-r{flex-direction:column}}
.arch-l{flex:1;background:rgba(15,15,20,.6);border:1px solid var(--border-s);border-radius:10px;padding:16px;transition:all .3s}
.arch-l:hover{border-color:var(--border);background:rgba(15,15,20,.8)}
.arch-l h3{font-size:12px;font-weight:800;margin-bottom:10px;padding-bottom:8px}
.pills{display:flex;flex-wrap:wrap;gap:6px}
.pill{font-size:10px;font-weight:700;padding:4px 10px;border-radius:14px;color:#09090b}
.arch-mid{text-align:center;color:#3f3f46;font-size:11px;padding:8px 0;font-weight:600;letter-spacing:.5px}

/* Footer */
.footer{text-align:center;padding:48px 0 24px;border-top:1px solid var(--border-s);margin-top:48px}
.footer-brand{font-size:13px;font-weight:700;color:var(--fg-muted);margin-bottom:4px}
.footer-sub{font-size:11px;color:var(--fg-subtle)}

/* Units reference grid */
.units-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
@media(max-width:1000px){.units-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:640px){.units-grid{grid-template-columns:1fr}}
.unit-card{background:var(--card);border:1px solid var(--border-s);border-radius:14px;padding:20px;transition:all .3s;position:relative;overflow:hidden}
.unit-card:hover{background:var(--card-h);border-color:var(--border);transform:translateY(-2px);box-shadow:0 8px 32px rgba(0,0,0,.3)}
.unit-card .uc-top{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.unit-card .uc-icon{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0}
.unit-card .uc-name{font-size:14px;font-weight:800;color:#f4f4f5}
.unit-card .uc-count{font-size:11px;font-weight:700;color:var(--fg-subtle);margin-left:auto}
.unit-card .uc-desc{font-size:11px;color:var(--fg-muted);line-height:1.5;margin-bottom:10px}
.unit-card .uc-meta{display:flex;flex-wrap:wrap;gap:4px}
.unit-card .uc-tag{font-size:9px;font-weight:600;padding:2px 6px;border-radius:3px;background:rgba(255,255,255,.05);color:var(--fg-subtle)}
</style>
</head>
<body>
<div class="wrap">

<!-- HEADER -->
<div class="hdr">
  <div class="hdr-icon"><svg viewBox="0 0 24 24"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" stroke-linejoin="round"/></svg></div>
  <div><h1>Catalyst AI Registry</h1><div class="sub"><span class="live"></span> Mission Control Â· Live Data Â· Feb 19, 2026</div></div>
</div>

<!-- STATS -->
<div class="stats reveal" id="stats"></div>

<!-- DIVIDER -->
<div class="divider"><div class="divider-line"></div><div class="divider-label">Registry Breakdown</div><div class="divider-line"></div></div>

<!-- ENTITY BARS + LINK TABLE -->
<div class="grid2 reveal">
  <div class="card">
    <div class="card-h"><div class="dot" style="background:#38bdf8"></div><h2>Entity Distribution Â· 735 total</h2></div>
    <div class="card-b" id="bars"></div>
  </div>
  <div class="card">
    <div class="card-h"><div class="dot" style="background:#4ade80"></div><h2>Link Graph Â· 2,425 connections</h2></div>
    <div class="card-b"><table class="lt" id="ltable"></table></div>
  </div>
</div>

<div class="divider"><div class="divider-line"></div><div class="divider-label">Entity Network</div><div class="divider-line"></div></div>

<!-- D3 NETWORK GRAPH -->
<div class="card full reveal">
  <div class="card-h"><div class="dot" style="background:#fbbf24"></div><h2>Entity Relationship Network â€” Interactive Force Graph</h2></div>
  <div class="card-b"><div id="network"></div></div>
</div>

<div class="divider"><div class="divider-line"></div><div class="divider-label">Analysis</div><div class="divider-line"></div></div>

<!-- DOMAIN RADAR + TOP LINKED -->
<div class="grid2e reveal">
  <div class="card">
    <div class="card-h"><div class="dot" style="background:#818cf8"></div><h2>Domain Distribution</h2></div>
    <div class="card-b"><div class="chart-wrap"><canvas id="domainChart"></canvas></div></div>
  </div>
  <div class="card">
    <div class="card-h"><div class="dot" style="background:#f87171"></div><h2>Most Connected Entities</h2></div>
    <div class="card-b" id="topLinked"></div>
  </div>
</div>

<!-- TAG COVERAGE + ARTIFACT HEALTH -->
<div class="grid2e reveal" style="margin-top:20px">
  <div class="card">
    <div class="card-h"><div class="dot" style="background:#c084fc"></div><h2>Tag Namespace Coverage</h2></div>
    <div class="card-b"><div class="tg" id="tagGrid"></div></div>
  </div>
  <div class="card">
    <div class="card-h"><div class="dot" style="background:#2dd4bf"></div><h2>Artifact Health Â· 52.5%</h2></div>
    <div class="card-b">
      <div class="art-row">
        <div class="donut-w"><canvas id="donut"></canvas><div class="donut-c"><div class="p">52.5%</div><div class="pl">with artifacts</div></div></div>
        <div class="art-l" id="artList"></div>
      </div>
    </div>
  </div>
</div>

<div class="divider"><div class="divider-line"></div><div class="divider-label">Quality Metrics</div><div class="divider-line"></div></div>

<!-- AVG TAGS + KB QUALITY -->
<div class="grid2e reveal">
  <div class="card">
    <div class="card-h"><div class="dot" style="background:#fb923c"></div><h2>Avg Tags per Entity Type</h2></div>
    <div class="card-b"><div class="chart-wrap"><canvas id="tagsChart"></canvas></div></div>
  </div>
  <div class="card">
    <div class="card-h"><div class="dot" style="background:#f472b6"></div><h2>KB Variant Depth (avg chars)</h2></div>
    <div class="card-b"><div class="chart-wrap"><canvas id="kbChart"></canvas></div></div>
  </div>
</div>

<div class="divider"><div class="divider-line"></div><div class="divider-label">Architecture</div><div class="divider-line"></div></div>

<!-- ARCHITECTURE -->
<div class="card full reveal">
  <div class="card-h"><div class="dot" style="background:#e879f9"></div><h2>System Architecture</h2></div>
  <div class="card-b" id="arch"></div>
</div>

<div class="divider"><div class="divider-line"></div><div class="divider-label">The 16 Atomic Units</div><div class="divider-line"></div></div>

<div class="units-grid reveal" id="unitsGrid"></div>

<div class="footer">
  <div class="footer-brand">Catalyst AI Registry</div>
  <div class="footer-sub">Higher Learning Technologies Â· Powered by Supabase Â· Built by Victoria</div>
</div>
</div>

<script>
// â”€â”€â”€ SCROLL REVEAL â”€â”€â”€
const observer=new IntersectionObserver((entries)=>{entries.forEach(e=>{if(e.isIntersecting){e.target.classList.add('visible');observer.unobserve(e.target)}})},{threshold:0.1,rootMargin:'0px 0px -40px 0px'});
document.querySelectorAll('.reveal').forEach(el=>observer.observe(el));

// â”€â”€â”€ STAT CARD MOUSE TRACKING â”€â”€â”€
document.querySelectorAll('.sc').forEach(el=>{el.addEventListener('mousemove',e=>{const r=el.getBoundingClientRect();el.style.setProperty('--x',(e.clientX-r.left)+'px');el.style.setProperty('--y',(e.clientY-r.top)+'px')})});

const C={skill:'#38bdf8',recipe:'#4ade80',content_type:'#fbbf24',metric:'#c084fc',kb:'#f87171',style:'#a78bfa',tool:'#fb923c',prompt:'#f472b6',channel:'#60a5fa',rubric:'#a3e635',schema:'#34d399',playbook:'#2dd4bf',bundle:'#67e8f9',lint_rule:'#e879f9',agent:'#818cf8',lint_ruleset:'#eab308'};

// â”€â”€â”€ STATS â”€â”€â”€
const stats=[{l:'Entities',v:735},{l:'Types',v:16},{l:'Links',v:2425},{l:'Apps',v:208},{l:'Revisions',v:1620},{l:'Artifacts',v:850}];
const sEl=document.getElementById('stats');
stats.forEach(s=>{const d=document.createElement('div');d.className='sc';d.innerHTML=`<div class="v" data-t="${s.v}">0</div><div class="l">${s.l}</div>`;sEl.appendChild(d)});
function animV(el,end){let st=null;const step=ts=>{if(!st)st=ts;const p=Math.min((ts-st)/1200,1);el.textContent=Math.floor(p*end).toLocaleString();if(p<1)requestAnimationFrame(step);else el.textContent=end.toLocaleString()};requestAnimationFrame(step)}
document.querySelectorAll('.v[data-t]').forEach(el=>animV(el,+el.dataset.t));

// â”€â”€â”€ ENTITY BARS â”€â”€â”€
const entities=[{n:'Skills',v:160,c:C.skill},{n:'Recipes',v:118,c:C.recipe},{n:'Content Types',v:113,c:C.content_type},{n:'Metrics',v:55,c:C.metric},{n:'KB Items',v:54,c:C.kb},{n:'Styles',v:48,c:C.style},{n:'Tools',v:42,c:C.tool},{n:'Prompts',v:31,c:C.prompt},{n:'Channels',v:27,c:C.channel},{n:'Rubrics',v:25,c:C.rubric},{n:'Schemas',v:21,c:C.schema},{n:'Playbooks',v:13,c:C.playbook},{n:'Bundles',v:11,c:C.bundle},{n:'Lint Rules',v:8,c:C.lint_rule},{n:'Agents',v:6,c:C.agent},{n:'Lint Rulesets',v:3,c:C.lint_ruleset}];
const bEl=document.getElementById('bars');
entities.forEach((e,i)=>{const d=document.createElement('div');d.className='bar';d.innerHTML=`<div class="bar-n">${e.n}</div><div class="bar-t"><div class="bar-f" style="width:0%;background:${e.c}">${e.v}</div></div>`;bEl.appendChild(d);setTimeout(()=>d.querySelector('.bar-f').style.width=`${(e.v/160)*100}%`,80+i*40)});

// â”€â”€â”€ LINK TABLE â”€â”€â”€
const links=[{t:'requires',v:714,c:'#ef4444'},{t:'recommends',v:555,c:'#3b82f6'},{t:'related',v:506,c:'#6b7280'},{t:'uses_tool',v:210,c:'#fb923c'},{t:'uses_prompt',v:125,c:'#a78bfa'},{t:'bundle_member',v:107,c:'#d946ef'},{t:'uses_kb',v:70,c:'#60a5fa'},{t:'alternate',v:67,c:'#78716c'},{t:'pairs_with',v:59,c:'#ec4899'},{t:'often_follows',v:9,c:'#84cc16'},{t:'prerequisite',v:2,c:'#fca5a5'},{t:'parent',v:1,c:'#5eead4'}];
const ltEl=document.getElementById('ltable');
ltEl.innerHTML='<thead><tr><th>Type</th><th>Count</th><th></th></tr></thead><tbody>'+links.map(l=>`<tr><td><span class="badge" style="background:${l.c}22;color:${l.c}">${l.t}</span></td><td style="color:#f4f4f5;font-weight:600">${l.v}</td><td><div style="width:${(l.v/714)*100}%;height:4px;background:${l.c};border-radius:2px;min-width:3px"></div></td></tr>`).join('')+'</tbody>';

// â”€â”€â”€ D3 FORCE NETWORK â”€â”€â”€
(function(){
const w=document.getElementById('network');
const width=w.clientWidth||800, height=500;
const svg=d3.select('#network').append('svg').attr('viewBox',`0 0 ${width} ${height}`);
const defs=svg.append('defs');

const nodes=[
  {id:'content_type',label:'Content Types',count:113,color:C.content_type,r:30},
  {id:'skill',label:'Skills',count:160,color:C.skill,r:35},
  {id:'recipe',label:'Recipes',count:118,color:C.recipe,r:28},
  {id:'metric',label:'Metrics',count:55,color:C.metric,r:20},
  {id:'kb',label:'KB Items',count:54,color:C.kb,r:20},
  {id:'style',label:'Styles',count:48,color:C.style,r:18},
  {id:'tool',label:'Tools',count:42,color:C.tool,r:18},
  {id:'prompt',label:'Prompts',count:31,color:C.prompt,r:16},
  {id:'channel',label:'Channels',count:27,color:C.channel,r:15},
  {id:'rubric',label:'Rubrics',count:25,color:C.rubric,r:14},
  {id:'schema',label:'Schemas',count:21,color:C.schema,r:13},
  {id:'playbook',label:'Playbooks',count:13,color:C.playbook,r:11},
  {id:'bundle',label:'Bundles',count:11,color:C.bundle,r:10},
  {id:'lint_rule',label:'Lint Rules',count:8,color:C.lint_rule,r:9},
  {id:'agent',label:'Agents',count:6,color:C.agent,r:8},
  {id:'lint_ruleset',label:'Lint Rulesets',count:3,color:C.lint_ruleset,r:7}
];

const edgeData=[
  {s:'content_type',t:'recipe',v:113},{s:'content_type',t:'tool',v:113},{s:'content_type',t:'prompt',v:113},
  {s:'content_type',t:'rubric',v:113},{s:'content_type',t:'metric',v:113},{s:'content_type',t:'style',v:113},
  {s:'content_type',t:'channel',v:113},{s:'recipe',t:'schema',v:118},{s:'recipe',t:'style',v:118},
  {s:'recipe',t:'channel',v:118},{s:'skill',t:'tool',v:82},{s:'skill',t:'kb',v:68},
  {s:'metric',t:'rubric',v:76},{s:'kb',t:'content_type',v:46},{s:'kb',t:'channel',v:46},
  {s:'kb',t:'style',v:46},{s:'playbook',t:'bundle',v:30},{s:'playbook',t:'prompt',v:11}
];

const edgeLinks=edgeData.map(e=>({source:e.s,target:e.t,value:e.v}));

edgeData.forEach((e,i)=>{
  const g=defs.append('linearGradient').attr('id','lg'+i).attr('gradientUnits','userSpaceOnUse');
  const sc=nodes.find(n=>n.id===e.s).color;
  const tc=nodes.find(n=>n.id===e.t).color;
  g.append('stop').attr('offset','0%').attr('stop-color',sc).attr('stop-opacity',0.6);
  g.append('stop').attr('offset','100%').attr('stop-color',tc).attr('stop-opacity',0.6);
});

const sim=d3.forceSimulation(nodes)
  .force('link',d3.forceLink(edgeLinks).id(d=>d.id).distance(120).strength(0.3))
  .force('charge',d3.forceManyBody().strength(-400))
  .force('center',d3.forceCenter(width/2,height/2))
  .force('collision',d3.forceCollide().radius(d=>d.r+15));

const link=svg.append('g').selectAll('line').data(edgeLinks).join('line')
  .attr('stroke',(d,i)=>'url(#lg'+i+')')
  .attr('stroke-width',d=>Math.max(1,d.value/30))
  .attr('stroke-opacity',0.5);

const node=svg.append('g').selectAll('g').data(nodes).join('g')
  .call(d3.drag().on('start',(e,d)=>{if(!e.active)sim.alphaTarget(.3).restart();d.fx=d.x;d.fy=d.y})
  .on('drag',(e,d)=>{d.fx=e.x;d.fy=e.y})
  .on('end',(e,d)=>{if(!e.active)sim.alphaTarget(0);d.fx=null;d.fy=null}));

node.append('circle').attr('r',d=>d.r).attr('fill',d=>d.color).attr('fill-opacity',0.8)
  .attr('stroke',d=>d.color).attr('stroke-width',2).attr('stroke-opacity',0.3)
  .style('cursor','grab')
  .on('mouseover',function(e,d){d3.select(this).transition().duration(200).attr('r',d.r+5).attr('fill-opacity',1).attr('stroke-opacity',0.6)})
  .on('mouseout',function(e,d){d3.select(this).transition().duration(200).attr('r',d.r).attr('fill-opacity',0.8).attr('stroke-opacity',0.3)});

node.append('text').attr('class','node-label').attr('dy',d=>d.r+14).text(d=>d.label);
node.append('text').attr('class','node-label').attr('dy',d=>d.r+25).attr('fill','#64748b').attr('font-size','9px').text(d=>d.count);

sim.on('tick',()=>{
  link.attr('x1',d=>d.source.x).attr('y1',d=>d.source.y).attr('x2',d=>d.target.x).attr('y2',d=>d.target.y);
  edgeData.forEach((e,i)=>{
    const g=defs.select('#lg'+i);
    const sl=edgeLinks[i];
    g.attr('x1',sl.source.x).attr('y1',sl.source.y).attr('x2',sl.target.x).attr('y2',sl.target.y);
  });
  node.attr('transform',d=>`translate(${d.x},${d.y})`);
});
})();

// â”€â”€â”€ DOMAIN CHART (Polar Area) â”€â”€â”€
const domains=[{l:'engineering',v:49},{l:'writing',v:38},{l:'education',v:30},{l:'mcp',v:27},{l:'data',v:26},{l:'ai-sdk',v:20},{l:'marketing',v:18},{l:'design',v:5},{l:'cms',v:4},{l:'product',v:4},{l:'database',v:3},{l:'nursing',v:2},{l:'dental',v:2}];
new Chart(document.getElementById('domainChart'),{
  type:'polarArea',
  data:{labels:domains.map(d=>d.l),datasets:[{data:domains.map(d=>d.v),backgroundColor:['#38bdf8','#4ade80','#fbbf24','#c084fc','#f87171','#a78bfa','#fb923c','#f472b6','#60a5fa','#a3e635','#34d399','#2dd4bf','#67e8f9'].map(c=>c+'88')}]},
  options:{responsive:true,maintainAspectRatio:false,scales:{r:{grid:{color:'rgba(255,255,255,.05)'},ticks:{display:false}}},plugins:{legend:{display:false}}}
});

// â”€â”€â”€ TOP LINKED ENTITIES â”€â”€â”€
const topLinked=[{n:'Web',t:'channel',v:165},{n:'Find Skills',t:'skill',v:74},{n:'Bash Run',t:'tool',v:64},{n:'Tools Guide Overview',t:'kb',v:59},{n:'Golden Cohort',t:'bundle',v:53},{n:'Engagement V1',t:'rubric',v:51},{n:'Systematic Debugging',t:'skill',v:49},{n:'Assessment',t:'style',v:46},{n:'Content Quality',t:'rubric',v:39},{n:'Article Standard',t:'content_type',v:38}];
const tlEl=document.getElementById('topLinked');
topLinked.forEach((e,i)=>{
  const d=document.createElement('div');
  d.style.cssText='display:flex;align-items:center;gap:8px;padding:5px 0;border-bottom:1px solid rgba(255,255,255,.03)';
  d.innerHTML=`<span style="font-size:11px;color:#64748b;width:16px">${i+1}</span><span style="width:6px;height:6px;border-radius:50%;background:${C[e.t]};flex-shrink:0"></span><span style="font-size:11px;color:#e2e8f0;flex:1">${e.n}</span><span style="font-size:10px;color:#64748b">${e.t}</span><span style="font-size:11px;font-weight:700;color:#f4f4f5">${e.v}</span>`;
  tlEl.appendChild(d);
});

// â”€â”€â”€ TAG GRID â”€â”€â”€
const tags=[{n:'scope',v:733},{n:'status',v:732},{n:'modality',v:473},{n:'format',v:426},{n:'channel',v:248},{n:'source',v:232},{n:'domain',v:227},{n:'action',v:175},{n:'family',v:115},{n:'stage',v:103},{n:'surface',v:78},{n:'partner',v:65},{n:'tool_type',v:52},{n:'provider',v:46},{n:'dept',v:16},{n:'persona_role',v:6}];
const tgEl=document.getElementById('tagGrid');
tags.forEach(t=>{const op=Math.max(.08,t.v/733*.7);const d=document.createElement('div');d.className='tc';d.style.background=`rgba(139,92,246,${op})`;d.innerHTML=`<div class="tn">${t.n}</div><div class="tv">${t.v}</div>`;tgEl.appendChild(d)});

// â”€â”€â”€ DONUT â”€â”€â”€
new Chart(document.getElementById('donut'),{type:'doughnut',data:{labels:['With Artifacts','Without'],datasets:[{data:[850,770],backgroundColor:['#2dd4bf','#27272a'],borderWidth:0}]},options:{cutout:'72%',plugins:{legend:{display:false},tooltip:{enabled:false}},responsive:true,maintainAspectRatio:true}});
const artifacts=[{n:'Skills',v:271,c:C.skill},{n:'Recipes',v:118,c:C.recipe},{n:'Content Types',v:113,c:C.content_type},{n:'Metrics',v:59,c:C.metric},{n:'KB Items',v:54,c:C.kb},{n:'Styles',v:48,c:C.style},{n:'Tools',v:39,c:C.tool},{n:'Prompts',v:31,c:C.prompt},{n:'Channels',v:30,c:C.channel},{n:'Rubrics',v:25,c:C.rubric}];
const alEl=document.getElementById('artList');
artifacts.forEach(a=>alEl.innerHTML+=`<div class="ai"><div class="ad" style="background:${a.c}"></div><span style="color:#94a3b8">${a.n}</span><span style="color:#f4f4f5;font-weight:600;margin-left:auto">${a.v}</span></div>`);

// â”€â”€â”€ AVG TAGS CHART â”€â”€â”€
const avgTags=[{t:'tool',v:8.8},{t:'agent',v:8.3},{t:'prompt',v:7.1},{t:'kb',v:7.1},{t:'schema',v:6.8},{t:'skill',v:6.1},{t:'content_type',v:5.6},{t:'recipe',v:4.6},{t:'style',v:4.5},{t:'metric',v:4.1},{t:'channel',v:3.8},{t:'playbook',v:3.3},{t:'rubric',v:3},{t:'lint_rule',v:3},{t:'bundle',v:2.9}];
new Chart(document.getElementById('tagsChart'),{
  type:'bar',
  data:{labels:avgTags.map(d=>d.t),datasets:[{data:avgTags.map(d=>d.v),backgroundColor:avgTags.map(d=>(C[d.t]||'#666')+'cc'),borderRadius:4}]},
  options:{indexAxis:'y',responsive:true,maintainAspectRatio:false,scales:{x:{grid:{color:'rgba(255,255,255,.04)'},ticks:{color:'#64748b',font:{size:9}}},y:{grid:{display:false},ticks:{color:'#94a3b8',font:{size:9}}}},plugins:{legend:{display:false}}}
});

// â”€â”€â”€ KB QUALITY CHART â”€â”€â”€
new Chart(document.getElementById('kbChart'),{
  type:'bar',
  data:{labels:['Snippet','Distilled','Full'],datasets:[{label:'Avg Length',data:[486,1325,2376],backgroundColor:['#f87171aa','#fbbf24aa','#4ade80aa'],borderRadius:4},{label:'Max Length',data:[3017,2026,4381],backgroundColor:['#f8717144','#fbbf2444','#4ade8044'],borderRadius:4}]},
  options:{responsive:true,maintainAspectRatio:false,scales:{x:{grid:{color:'rgba(255,255,255,.04)'},ticks:{color:'#94a3b8'}},y:{grid:{color:'rgba(255,255,255,.04)'},ticks:{color:'#64748b',font:{size:9}}}},plugins:{legend:{labels:{color:'#94a3b8',font:{size:10}}}}}
});

// â”€â”€â”€ 16 ATOMIC UNITS REFERENCE â”€â”€â”€
const units=[
  {n:'Skills',c:160,color:C.skill,icon:'âš¡',desc:'Procedural knowledge for agents. Portable, activation-friendly instruction sets with SKILL.md entrypoints. Define how to do things â€” research, draft, evaluate, debug.',tags:['procedural','agent-ready','SKILL.md','unit.json']},
  {n:'Recipes',c:118,color:C.recipe,icon:'ðŸ§ª',desc:'Presets that bind schema + style + constraints. Ready-to-run configuration packages for consistent output. Not new schemas â€” packaging of existing ones.',tags:['preset','schema+style','RECIPE.json','constraints']},
  {n:'Content Types',c:113,color:C.content_type,icon:'ðŸ“„',desc:'Editor presets and publishing contracts. Define "what kind of asset is this?" â€” articles, qbank items, slide decks. Wire default recipe/style/channel expectations.',tags:['publishing','modalities','ops pipeline','CMS editor']},
  {n:'Metrics',c:55,color:C.metric,icon:'ðŸ“Š',desc:'What gets measured. Define units, aggregation methods, and interpretation. Track content performance, A/B test outcomes, retention signals.',tags:['measurement','aggregation','dashboards','experiments']},
  {n:'KB Items',c:54,color:C.kb,icon:'ðŸ“š',desc:'Long-form reference context with no length limit. Domain expertise, best practices, and citeable reference packets. Three variants: snippet, distilled, full.',tags:['reference','context','KB.md','3 variants']},
  {n:'Styles',c:48,color:C.style,icon:'ðŸŽ¨',desc:'Formatting overlays â€” tone, voice, and structure constraints that don\'t change schema shape. Give agents a stable "house style" to apply consistently.',tags:['tone/voice','overlays','constraints','non-schema']},
  {n:'Tools',c:42,color:C.tool,icon:'ðŸ”§',desc:'Executable capabilities with explicit I/O contracts. External APIs, internal services, deterministic actions. Types: MCP, HTTP, internal, SDK, CLI.',tags:['executable','I/O contract','mcp/http/cli','auditable']},
  {n:'Prompts',c:31,color:C.prompt,icon:'ðŸ’¬',desc:'Structured instruction contracts â€” system, task, format, policy, rubric prompts. Not one-liners. Must include objective, inputs, instructions, output format, guardrails.',tags:['instructions','reusable','structured','versioned']},
  {n:'Channels',c:27,color:C.channel,icon:'ðŸ“¡',desc:'Delivery surface constraints. Platform-specific limits like max chars, carousel support, alt text requirements. Enforce output standards per surface.',tags:['delivery','platform limits','surface rules','output']},
  {n:'Rubrics',c:25,color:C.rubric,icon:'âœ…',desc:'Evaluation criteria with scores, weights, and pass/fail thresholds. Evidence-first, composable. Power A/B tests, pairwise judging, and quality scoring.',tags:['evaluation','scoring','criteria','thresholds']},
  {n:'Schemas',c:21,color:C.schema,icon:'ðŸ”·',desc:'Output shape contracts â€” the most fragile units requiring strongest testing. Enforce structured outputs, validate content type payloads. Tests mandatory.',tags:['JSON shape','validation','tests required','fragile']},
  {n:'Playbooks',c:13,color:C.playbook,icon:'ðŸ“‹',desc:'Ordered multi-step patterns. Define recommended sequences of skills/tools. Three modes: strict (required order), guided (suggested), adaptive (weighted hints).',tags:['multi-step','sequenced','3 modes','workflow']},
  {n:'Bundles',c:11,color:C.bundle,icon:'ðŸ“¦',desc:'Curated collections of units without imposed order. Starter kits, context bundles, grouped skills/KB/tools for discovery. Membership via entity_links.',tags:['collection','unordered','starter kits','grouping']},
  {n:'Lint Rules',c:8,color:C.lint_rule,icon:'ðŸ”',desc:'Machine-checkable validations for readability, structure, brand compliance. Power "readiness strips" and ambient validation in preview/render surfaces.',tags:['validation','automated','quality gates','severity']},
  {n:'Agents',c:6,color:C.agent,icon:'ðŸ¤–',desc:'Personas + preferences, not capabilities. Reusable voice/role profiles with model defaults, temperature settings, and proclivities (prefer/avoid patterns).',tags:['persona','voice/role','proclivities','defaults']},
  {n:'Lint Rulesets',c:3,color:C.lint_ruleset,icon:'ðŸ“',desc:'Ordered collections of lint rules grouped for a surface. Define "run lint" actions for blog publishing, CMS content, etc. Membership via lint_ruleset_rules.',tags:['rule groups','ordered','surface-scoped','sequence']}
];
const ugEl=document.getElementById('unitsGrid');
units.forEach(u=>{
  const d=document.createElement('div');d.className='unit-card';
  d.innerHTML=`<div class="uc-top"><div class="uc-icon" style="background:${u.color}22;color:${u.color}">${u.icon}</div><div class="uc-name">${u.n}</div><div class="uc-count">${u.c}</div></div><div class="uc-desc">${u.desc}</div><div class="uc-meta">${u.tags.map(t=>`<span class="uc-tag">${t}</span>`).join('')}</div>`;
  ugEl.appendChild(d);
});

// â”€â”€â”€ ARCHITECTURE â”€â”€â”€
document.getElementById('arch').innerHTML=`
<div class="arch">
  <div class="arch-r">
    <div class="arch-l"><h3 style="border-bottom:2px solid ${C.content_type};color:${C.content_type}">Content Pipeline</h3><div class="pills"><span class="pill" style="background:${C.content_type}">Content Types Â· 113</span><span class="pill" style="background:${C.recipe}">Recipes Â· 118</span><span class="pill" style="background:${C.schema}">Schemas Â· 21</span><span class="pill" style="background:${C.style}">Styles Â· 48</span><span class="pill" style="background:${C.channel}">Channels Â· 27</span></div></div>
    <div class="arch-l"><h3 style="border-bottom:2px solid ${C.skill};color:${C.skill}">Support Layer</h3><div class="pills"><span class="pill" style="background:${C.skill}">Skills Â· 160</span><span class="pill" style="background:${C.kb}">KB Items Â· 54</span><span class="pill" style="background:${C.tool}">Tools Â· 42</span><span class="pill" style="background:${C.prompt}">Prompts Â· 31</span></div></div>
  </div>
  <div class="arch-mid">â–¼ entity_links (2,425) Â· entity_tags Â· entity_revisions Â· entity_embeddings â–¼</div>
  <div class="arch-r">
    <div class="arch-l"><h3 style="border-bottom:2px solid ${C.metric};color:${C.metric}">Evaluation Layer</h3><div class="pills"><span class="pill" style="background:${C.metric}">Metrics Â· 55</span><span class="pill" style="background:${C.rubric}">Rubrics Â· 25</span><span class="pill" style="background:${C.lint_rule}">Lint Rules Â· 8</span></div></div>
    <div class="arch-l"><h3 style="border-bottom:2px solid ${C.playbook};color:${C.playbook}">Execution Layer</h3><div class="pills"><span class="pill" style="background:${C.playbook}">Playbooks Â· 13</span><span class="pill" style="background:${C.bundle}">Bundles Â· 11</span><span class="pill" style="background:${C.agent}">Agents Â· 6</span></div></div>
  </div>
</div>`;
</script>
</body>
</html>
