<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalyst AI Registry</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-background: #09090b;
            --color-text: #e2e8f0;
            --color-text-muted: #64748b;
            --color-border: rgba(255, 255, 255, 0.06);
            --color-glass-bg: rgba(39, 39, 42, 0.5);

            /* Entity Colors */
            --c-skills: #38bdf8; --c-recipes: #4ade80; --c-content-types: #fbbf24;
            --c-metrics: #c084fc; --c-kb-items: #f87171; --c-styles: #a78bfa;
            --c-tools: #fb923c; --c-prompts: #f472b6; --c-channels: #60a5fa;
            --c-rubrics: #a3e635; --c-schemas: #34d399; --c-playbooks: #2dd4bf;
            --c-bundles: #67e8f9; --c-lint-rules: #e879f9; --c-agents: #818cf8;
            --c-lint-rulesets: #eab308;
            
            /* Link Type Colors */
            --l-requires: #ef4444; --l-recommends: #3b82f6; --l-related: #6b7280;
            --l-uses_tool: #fb923c; --l-uses_prompt: #a78bfa; --l-bundle_member: #d946ef;
            --l-uses_kb: #60a5fa; --l-alternate: #78716c; --l-pairs_with: #ec4899;
            --l-often_follows: #84cc16; --l-prerequisite: #fca5a5; --l-parent: #5eead4;
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-background);
            color: var(--color-text);
            font-size: 14px;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(circle at 25% 30%, rgba(22, 163, 74, 0.1), transparent 30%),
                radial-gradient(circle at 75% 80%, rgba(99, 102, 241, 0.1), transparent 30%);
            z-index: -2;
        }

        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 4rem 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 4rem;
        }
        
        .dot-grid {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-image: radial-gradient(circle, #27272a 1px, transparent 1px);
            background-size: 20px 20px;
            z-index: -1;
            opacity: 0.5;
        }

        h1, h2, h3 {
            font-weight: 600;
            color: #fafafa;
        }
        
        h2 { font-size: 1.5rem; }
        h3 { font-size: 1.125rem; }

        .text-muted {
            color: var(--color-text-muted);
        }

        .grid {
            display: grid;
            gap: 1.5rem;
        }
        
        .grid-2-col {
            grid-template-columns: 3fr 2fr;
        }

        .glass-card {
            background-color: var(--color-glass-bg);
            border: 1px solid var(--color-border);
            border-radius: 0.75rem;
            padding: 1.5rem;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        /* Header */
        header {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header-title svg {
            width: 28px;
            height: 28px;
            color: #a78bfa;
        }

        .header-title h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .header-title .subtitle {
            font-size: 0.75rem;
            margin-left: 0.5rem;
            padding-left: 1rem;
            border-left: 1px solid var(--color-border);
        }

        .stats-grid {
            grid-template-columns: repeat(6, 1fr);
        }

        .stat-card {
            padding: 1rem;
            text-align: center;
        }
        
        .stat-card .value {
            font-size: 2.25rem;
            font-weight: 700;
            line-height: 1.2;
            color: #fafafa;
        }
        
        .stat-card .label {
            font-size: 0.875rem;
            color: var(--color-text-muted);
        }

        /* Section: Entity & Link Types */
        .bar-chart-container h3, .link-types-container h3 {
            margin-bottom: 1.5rem;
        }
        
        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .bar-chart-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .bar-chart-item .label {
            width: 120px;
            text-align: right;
            font-size: 0.875rem;
            flex-shrink: 0;
        }
        
        .bar-chart-item .bar-wrapper {
            flex-grow: 1;
            background-color: rgba(255,255,255,0.05);
            border-radius: 999px;
            height: 24px;
            position: relative;
        }
        
        .bar-chart-item .bar {
            position: absolute;
            left: 0; top: 0;
            height: 100%;
            border-radius: 999px;
            width: 0;
            transition: width 1s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .bar-chart-container.is-visible .bar {
            width: var(--bar-width);
            transition-delay: var(--delay);
        }
        
        .bar-chart-item .count {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.75rem;
            font-weight: 500;
            color: #09090b;
        }

        .link-types-table {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .link-type-row {
            display: grid;
            grid-template-columns: 120px 50px 1fr;
            align-items: center;
            gap: 1rem;
            font-size: 0.875rem;
        }
        
        .link-type-row .badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .link-type-row .badge-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        
        .link-type-row .mini-bar {
            height: 4px;
            border-radius: 2px;
            width: var(--bar-width);
        }

        /* Section: D3 Force Graph */
        .force-graph-container {
            position: relative;
            width: 100%;
            height: 700px;
            border-radius: 0.75rem;
            border: 1px solid var(--color-border);
            background-color: var(--color-glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            overflow: hidden;
        }

        .force-graph-container::before {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 80%; height: 80%;
            background: radial-gradient(circle, rgba(167, 139, 250, 0.08), transparent 60%);
            z-index: 0;
        }
        
        #force-graph {
            width: 100%;
            height: 100%;
            position: relative;
            z-index: 1;
        }
        
        #force-graph .node circle {
            stroke: rgba(255, 255, 255, 0.5);
            stroke-width: 1.5px;
            transition: transform 0.2s ease-out;
        }

        #force-graph .node:hover circle {
            transform: scale(1.3);
        }
        
        #force-graph .node text {
            fill: var(--color-text);
            font-size: 10px;
            font-weight: 500;
            pointer-events: none;
            text-anchor: middle;
            paint-order: stroke;
            stroke: var(--color-background);
            stroke-width: 3px;
            stroke-linecap: butt;
            stroke-linejoin: miter;
        }
        
        #force-graph .link {
            stroke-opacity: 0.6;
        }
        
        .d3-tooltip {
            position: absolute;
            visibility: hidden;
            padding: 0.75rem;
            background: rgba(20, 20, 22, 0.9);
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
            color: var(--color-text);
            font-size: 0.875rem;
            pointer-events: none;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 10;
        }
        .d3-tooltip h4 { color: #fafafa; margin-bottom: 0.5rem; font-size: 1rem; }
        .d3-tooltip ul { list-style: none; padding-left: 0; }
        .d3-tooltip li { margin-bottom: 0.25rem; font-size: 0.8rem; }

        /* Section: Tag Coverage & Artifact Health */
        .tag-coverage-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
        }

        .tag-cell {
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            background: linear-gradient(45deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tag-cell .name { font-weight: 500; }
        .tag-cell .count { color: var(--color-text-muted); }

        .artifact-health-container {
            position: relative;
        }
        
        .donut-chart-wrapper {
            position: relative;
            max-width: 200px;
            margin: 0 auto 1.5rem;
        }
        
        .donut-center-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
            color: #fafafa;
        }
        
        .health-breakdown {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .health-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
        }
        
        .health-item-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .health-item-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        /* Section: Architecture */
        .architecture-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }
        
        .arch-row {
            display: flex;
            gap: 1.5rem;
            width: 100%;
            justify-content: center;
        }
        
        .arch-card {
            flex: 1;
            padding: 1rem 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            border-left: 4px solid;
        }
        .arch-card.amber { border-color: #f59e0b; }
        .arch-card.sky { border-color: #0ea5e9; }
        .arch-card.purple { border-color: #a855f7; }
        .arch-card.teal { border-color: #14b8a6; }
        
        .arch-card h4 { font-size: 1rem; font-weight: 600; color: #fafafa; }
        
        .arch-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .pill {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--color-text);
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .pill::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--color);
        }
        
        .arch-arrow {
            color: var(--color-text-muted);
            font-family: monospace;
            text-align: center;
            padding: 0.5rem 0;
            border-bottom: 1px dashed var(--color-border);
            width: 80%;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 2rem 0;
            font-size: 0.875rem;
            color: var(--color-text-muted);
        }

        @media (max-width: 1024px) {
            main { gap: 3rem; }
            .grid-2-col { grid-template-columns: 1fr; }
            .bar-chart-item .label { width: 100px; }
        }
        
        @media (max-width: 768px) {
            main { padding: 2rem 1rem; }
            .header-title { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
            .header-title .subtitle { margin-left: 0; padding-left: 0; border-left: none; }
            .stats-grid { grid-template-columns: repeat(3, 1fr); }
            .tag-coverage-grid { grid-template-columns: repeat(2, 1fr); }
            .arch-row { flex-direction: column; }
        }
        
        @media (max-width: 480px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }

    </style>
</head>
<body>
    <div class="dot-grid"></div>

    <main>
        <!-- SECTION 1: HEADER -->
        <header>
            <div class="header-title">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z" />
                </svg>
                <h1>Catalyst AI Registry</h1>
                <span class="subtitle text-muted">Mission Control · Feb 19, 2026</span>
            </div>
            <div class="stats-grid grid">
                <div class="stat-card glass-card">
                    <div class="value" data-target="735">0</div>
                    <div class="label">Entities</div>
                </div>
                <div class="stat-card glass-card">
                    <div class="value" data-target="16">0</div>
                    <div class="label">Types</div>
                </div>
                <div class="stat-card glass-card">
                    <div class="value" data-target="2425">0</div>
                    <div class="label">Links</div>
                </div>
                <div class="stat-card glass-card">
                    <div class="value" data-target="208">0</div>
                    <div class="label">Apps</div>
                </div>
                <div class="stat-card glass-card">
                    <div class="value" data-target="1620">0</div>
                    <div class="label">Revisions</div>
                </div>
                <div class="stat-card glass-card">
                    <div class="value" data-target="850">0</div>
                    <div class="label">Artifacts</div>
                </div>
            </div>
        </header>

        <!-- SECTION 2: ENTITY & LINK TYPES -->
        <section class="grid grid-2-col">
            <div class="bar-chart-container glass-card" id="bar-chart-section">
                <h3>Entity Types</h3>
                <div class="bar-chart"></div>
            </div>
            <div class="link-types-container glass-card">
                <h3>Link Types</h3>
                <div class="link-types-table"></div>
            </div>
        </section>

        <!-- SECTION 3: FORCE-DIRECTED GRAPH -->
        <section class="force-graph-container">
            <svg id="force-graph"></svg>
            <div id="d3-tooltip" class="d3-tooltip"></div>
        </section>

        <!-- SECTION 4: TAG COVERAGE & ARTIFACT HEALTH -->
        <section class="grid grid-2-col">
            <div class="tag-coverage-container glass-card">
                <h3>Tag Coverage</h3>
                <div class="tag-coverage-grid" style="margin-top: 1.5rem;"></div>
            </div>
            <div class="artifact-health-container glass-card">
                <h3>Artifact Health</h3>
                <div class="donut-chart-wrapper">
                    <canvas id="artifact-health-chart"></canvas>
                    <div class="donut-center-text">52.5%</div>
                </div>
                <div class="health-breakdown"></div>
            </div>
        </section>

        <!-- SECTION 5: ARCHITECTURE DIAGRAM -->
        <section class="architecture-diagram">
            <div class="arch-row">
                <div class="glass-card arch-card amber">
                    <h4>Content Pipeline</h4>
                    <div class="arch-pills" id="arch-pills-pipeline"></div>
                </div>
                <div class="glass-card arch-card sky">
                    <h4>Support Layer</h4>
                    <div class="arch-pills" id="arch-pills-support"></div>
                </div>
            </div>
            <div class="arch-arrow">entity_links (2,425) · tags · revisions · embeddings</div>
            <div class="arch-row">
                <div class="glass-card arch-card purple">
                    <h4>Evaluation Layer</h4>
                    <div class="arch-pills" id="arch-pills-eval"></div>
                </div>
                <div class="glass-card arch-card teal">
                    <h4>Execution Layer</h4>
                    <div class="arch-pills" id="arch-pills-exec"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer>
        Catalyst AI Registry · Higher Learning Technologies · Powered by Supabase
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        const entityColors = {
            'Skills': '#38bdf8', 'Recipes': '#4ade80', 'Content Types': '#fbbf24',
            'Metrics': '#c084fc', 'KB Items': '#f87171', 'Styles': '#a78bfa',
            'Tools': '#fb923c', 'Prompts': '#f472b6', 'Channels': '#60a5fa',
            'Rubrics': '#a3e635', 'Schemas': '#34d399', 'Playbooks': '#2dd4bf',
            'Bundles': '#67e8f9', 'Lint Rules': '#e879f9', 'Agents': '#818cf8',
            'Lint Rulesets': '#eab308'
        };

        const linkTypeColors = {
            'requires': '#ef4444', 'recommends': '#3b82f6', 'related': '#6b7280',
            'uses_tool': '#fb923c', 'uses_prompt': '#a78bfa', 'bundle_member': '#d946ef',
            'uses_kb': '#60a5fa', 'alternate': '#78716c', 'pairs_with': '#ec4899',
            'often_follows': '#84cc16', 'prerequisite': '#fca5a5', 'parent': '#5eead4'
        };

        // 1. Animated Counters
        function animateCounters() {
            const counters = document.querySelectorAll('.value[data-target]');
            counters.forEach(counter => {
                const target = +counter.getAttribute('data-target');
                const duration = 1500;
                const stepTime = Math.abs(Math.floor(duration / target));
                let current = 0;
                const timer = setInterval(() => {
                    current += Math.ceil(target / (duration/16));
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    counter.innerText = current.toLocaleString();
                }, 16);
            });
        }

        // 2. Bar Chart
        function setupBarChart() {
            const data = [
                { label: 'Skills', value: 160, color: entityColors['Skills'] },
                { label: 'Recipes', value: 118, color: entityColors['Recipes'] },
                { label: 'Content Types', value: 113, color: entityColors['Content Types'] },
                { label: 'Metrics', value: 55, color: entityColors['Metrics'] },
                { label: 'KB Items', value: 54, color: entityColors['KB Items'] },
                { label: 'Styles', value: 48, color: entityColors['Styles'] },
                { label: 'Tools', value: 42, color: entityColors['Tools'] },
                { label: 'Prompts', value: 31, color: entityColors['Prompts'] },
                { label: 'Channels', value: 27, color: entityColors['Channels'] },
                { label: 'Rubrics', value: 25, color: entityColors['Rubrics'] },
                { label: 'Schemas', value: 21, color: entityColors['Schemas'] },
                { label: 'Playbooks', value: 13, color: entityColors['Playbooks'] },
                { label: 'Bundles', value: 11, color: entityColors['Bundles'] },
                { label: 'Lint Rules', value: 8, color: entityColors['Lint Rules'] },
                { label: 'Agents', value: 6, color: entityColors['Agents'] },
                { label: 'Lint Rulesets', value: 3, color: entityColors['Lint Rulesets'] },
            ];
            const container = document.querySelector('.bar-chart');
            const maxValue = Math.max(...data.map(d => d.value));

            data.forEach((item, index) => {
                const itemEl = document.createElement('div');
                itemEl.className = 'bar-chart-item';
                itemEl.innerHTML = `
                    <div class="label text-muted">${item.label}</div>
                    <div class="bar-wrapper">
                        <div class="bar" style="--bar-width: ${(item.value / maxValue) * 100}%; background-color: ${item.color}; --delay: ${index * 50}ms"></div>
                        <div class="count">${item.value}</div>
                    </div>
                `;
                container.appendChild(itemEl);
            });
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.5 });
            
            observer.observe(document.getElementById('bar-chart-section'));
        }
        
        // 2. Link Types Table
        function setupLinkTypesTable() {
            const data = [
                { label: 'requires', value: 714, color: linkTypeColors['requires'] },
                { label: 'recommends', value: 555, color: linkTypeColors['recommends'] },
                { label: 'related', value: 506, color: linkTypeColors['related'] },
                { label: 'uses_tool', value: 210, color: linkTypeColors['uses_tool'] },
                { label: 'uses_prompt', value: 125, color: linkTypeColors['uses_prompt'] },
                { label: 'bundle_member', value: 107, color: linkTypeColors['bundle_member'] },
                { label: 'uses_kb', value: 70, color: linkTypeColors['uses_kb'] },
                { label: 'alternate', value: 67, color: linkTypeColors['alternate'] },
                { label: 'pairs_with', value: 59, color: linkTypeColors['pairs_with'] },
                { label: 'often_follows', value: 9, color: linkTypeColors['often_follows'] },
                { label: 'prerequisite', value: 2, color: linkTypeColors['prerequisite'] },
                { label: 'parent', value: 1, color: linkTypeColors['parent'] },
            ];
            const container = document.querySelector('.link-types-table');
            const maxValue = Math.max(...data.map(d => d.value));

            data.forEach(item => {
                const itemEl = document.createElement('div');
                itemEl.className = 'link-type-row';
                itemEl.innerHTML = `
                    <div class="badge">
                        <div class="badge-dot" style="background-color: ${item.color};"></div>
                        <span>${item.label}</span>
                    </div>
                    <div class="count text-muted">${item.value}</div>
                    <div class="mini-bar-wrapper">
                        <div class="mini-bar" style="background-color: ${item.color}; --bar-width: ${(item.value / maxValue) * 100}%"></div>
                    </div>
                `;
                container.appendChild(itemEl);
            });
        }

        // 3. D3 Force Directed Graph
        function setupForceGraph() {
            const nodeData = [
                { id: 'Content Types', count: 113 }, { id: 'Recipes', count: 118 },
                { id: 'Tools', count: 42 }, { id: 'Prompts', count: 31 },
                { id: 'Rubrics', count: 25 }, { id: 'Metrics', count: 55 },
                { id: 'Styles', count: 48 }, { id: 'Channels', count: 27 },
                { id: 'Schemas', count: 21 }, { id: 'Skills', count: 160 },
                { id: 'KB Items', count: 54 }, { id: 'Playbooks', count: 13 },
                { id: 'Bundles', count: 11 }, { id: 'Lint Rules', count: 8 },
                { id: 'Agents', count: 6 }, { id: 'Lint Rulesets', count: 3 }
            ];

            const linkData = [
                { source: 'Content Types', target: 'Recipes', value: 113 },
                { source: 'Content Types', target: 'Tools', value: 113 },
                { source: 'Content Types', target: 'Prompts', value: 113 },
                { source: 'Content Types', target: 'Rubrics', value: 113 },
                { source: 'Content Types', target: 'Metrics', value: 113 },
                { source: 'Content Types', target: 'Styles', value: 113 },
                { source: 'Content Types', target: 'Channels', value: 113 },
                { source: 'Recipes', target: 'Schemas', value: 118 },
                { source: 'Recipes', target: 'Styles', value: 118 },
                { source: 'Recipes', target: 'Channels', value: 118 },
                { source: 'Skills', target: 'Tools', value: 82 },
                { source: 'Skills', target: 'KB Items', value: 68 },
                { source: 'Skills', target: 'Skills', value: 233 },
                { source: 'Metrics', target: 'Rubrics', value: 76 },
                { source: 'KB Items', target: 'Content Types', value: 46 },
                { source: 'KB Items', target: 'Channels', value: 46 },
                { source: 'KB Items', target: 'Styles', value: 46 },
                { source: 'KB Items', target: 'KB Items', value: 47 },
                { source: 'Playbooks', target: 'Bundles', value: 30 },
                { source: 'Playbooks', target: 'Prompts', value: 11 },
            ];

            const nodes = nodeData.map(d => ({...d, color: entityColors[d.id] }));
            
            const container = document.getElementById('force-graph');
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            const svg = d3.select("#force-graph")
                .attr("viewBox", [-width / 2, -height / 2, width, height]);

            const radiusScale = d3.scaleSqrt().domain([0, d3.max(nodes, d => d.count)]).range([5, 30]);
            const strokeScale = d3.scaleSqrt().domain([0, d3.max(linkData, d => d.value)]).range([1, 8]);
            
            // Tooltip
            const tooltip = d3.select("#d3-tooltip");
            const nodeConnections = {};
            linkData.forEach(l => {
                if (!nodeConnections[l.source]) nodeConnections[l.source] = [];
                if (!nodeConnections[l.target]) nodeConnections[l.target] = [];
                nodeConnections[l.source].push({ target: l.target, value: l.value });
                if (l.source !== l.target) {
                    nodeConnections[l.target].push({ target: l.source, value: l.value });
                }
            });

            const simulation = d3.forceSimulation(nodes)
                .force("link", d3.forceLink(linkData).id(d => d.id).distance(120))
                .force("charge", d3.forceManyBody().strength(-200))
                .force("center", d3.forceCenter(0, 0))
                .force("x", d3.forceX())
                .force("y", d3.forceY());

            const defs = svg.append("defs");
            linkData.forEach((d, i) => {
                const sourceNode = nodes.find(n => n.id === d.source);
                const targetNode = nodes.find(n => n.id === d.target);
                const gradient = defs.append("linearGradient")
                    .attr("id", `gradient-${i}`)
                    .attr("gradientUnits", "userSpaceOnUse");
                gradient.append("stop").attr("offset", "0%").attr("stop-color", sourceNode.color);
                gradient.append("stop").attr("offset", "100%").attr("stop-color", targetNode.color);
            });

            const link = svg.append("g")
                .attr("class", "links")
                .selectAll("line")
                .data(linkData)
                .join("line")
                .attr("class", "link")
                .attr("stroke-width", d => strokeScale(d.value))
                .attr("stroke", (d, i) => `url(#gradient-${i})`);

            const node = svg.append("g")
                .attr("class", "nodes")
                .selectAll("g")
                .data(nodes)
                .join("g")
                .attr("class", "node")
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));

            node.append("circle")
                .attr("r", d => radiusScale(d.count))
                .attr("fill", d => d.color);

            node.append("text")
                .text(d => d.id)
                .attr("dy", d => radiusScale(d.count) + 12);
                
            node.on("mouseover", (event, d) => {
                tooltip.style("visibility", "visible");
                const connections = (nodeConnections[d.id] || [])
                    .sort((a,b) => b.value - a.value)
                    .map(c => `<li>${c.target}: ${c.value}</li>`).join('');
                
                tooltip.html(`<h4>${d.id} (${d.count})</h4><ul>${connections || '<li>No connections</li>'}</ul>`);
                d3.select(event.currentTarget).raise();
            })
            .on("mousemove", (event) => {
                tooltip.style("top", (event.pageY - 10) + "px").style("left", (event.pageX + 10) + "px");
            })
            .on("mouseout", () => {
                tooltip.style("visibility", "hidden");
            });

            simulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y)
                    .each(function(d, i) {
                        const gradient = d3.select(`#gradient-${i}`);
                        gradient.attr("x1", d.source.x)
                                .attr("y1", d.source.y)
                                .attr("x2", d.target.x)
                                .attr("y2", d.target.y);
                    });
                node.attr("transform", d => `translate(${d.x},${d.y})`);
            });

            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }

            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }

            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
        }
        
        // 4. Tag Coverage
        function setupTagCoverage() {
            const data = [
                { name: 'scope', value: 733 }, { name: 'status', value: 732 },
                { name: 'modality', value: 473 }, { name: 'format', value: 426 },
                { name: 'channel', value: 248 }, { name: 'source', value: 232 },
                { name: 'domain', value: 227 }, { name: 'action', value: 175 },
                { name: 'family', value: 115 }, { name: 'stage', value: 103 },
                { name: 'surface', value: 78 }, { name: 'partner', value: 65 },
                { name: 'tool_type', value: 52 }, { name: 'provider', value: 46 },
                { name: 'dept', value: 16 }, { name: 'persona_role', value: 6 }
            ];
            const maxValue = 733;
            const container = document.querySelector('.tag-coverage-grid');
            data.forEach(item => {
                const cell = document.createElement('div');
                cell.className = 'tag-cell';
                cell.style.opacity = 0.4 + (item.value / maxValue) * 0.6;
                cell.innerHTML = `
                    <span class="name">${item.name}</span>
                    <span class="count">${item.value}</span>
                `;
                container.appendChild(cell);
            });
        }
        
        // 4. Artifact Health Donut Chart
        function setupArtifactHealthChart() {
            const ctx = document.getElementById('artifact-health-chart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [850, 770],
                        backgroundColor: ['#2dd4bf', '#27272a'],
                        borderWidth: 0,
                        borderRadius: 5,
                    }]
                },
                options: {
                    responsive: true,
                    cutout: '80%',
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });
            
            const breakdownData = [
                { label: 'Skills', value: 271 }, { label: 'Recipes', value: 118 },
                { label: 'Content Types', value: 113 }, { label: 'Metrics', value: 59 },
                { label: 'KB', value: 54 }, { label: 'Styles', value: 48 },
                { label: 'Tools', value: 39 }, { label: 'Prompts', value: 31 },
                { label: 'Channels', value: 30 }, { label: 'Rubrics', value: 25 },
            ];
            const breakdownContainer = document.querySelector('.health-breakdown');
            breakdownData.forEach(item => {
                const itemEl = document.createElement('div');
                itemEl.className = 'health-item';
                itemEl.innerHTML = `
                    <div class="health-item-label">
                        <div class="health-item-dot" style="background-color: ${entityColors[item.label === 'KB' ? 'KB Items' : item.label]}"></div>
                        <span>${item.label}</span>
                    </div>
                    <span class="text-muted">${item.value}</span>
                `;
                breakdownContainer.appendChild(itemEl);
            });
        }
        
        // 5. Architecture Diagram
        function setupArchitecture() {
            const archData = {
                pipeline: [['Content Types', 113], ['Recipes', 118], ['Schemas', 21], ['Styles', 48], ['Channels', 27]],
                support: [['Skills', 160], ['KB Items', 54], ['Tools', 42], ['Prompts', 31]],
                eval: [['Metrics', 55], ['Rubrics', 25], ['Lint Rules', 8]],
                exec: [['Playbooks', 13], ['Bundles', 11], ['Agents', 6]]
            };
            
            const createPills = (data) => {
                return data.map(([label, count]) => `
                    <div class="pill" style="--color: ${entityColors[label]}">
                        ${label}·${count}
                    </div>
                `).join('');
            };
            
            document.getElementById('arch-pills-pipeline').innerHTML = createPills(archData.pipeline);
            document.getElementById('arch-pills-support').innerHTML = createPills(archData.support);
            document.getElementById('arch-pills-eval').innerHTML = createPills(archData.eval);
            document.getElementById('arch-pills-exec').innerHTML = createPills(archData.exec);
        }

        // Initialize all components
        animateCounters();
        setupBarChart();
        setupLinkTypesTable();
        setupForceGraph();
        setupTagCoverage();
        setupArtifactHealthChart();
        setupArchitecture();
    });
    </script>
</body>
</html>